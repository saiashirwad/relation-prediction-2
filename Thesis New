{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Thesis New","provenance":[],"collapsed_sections":[],"mount_file_id":"153rcshd9spORr8e7LGR30RIj9QO6Q9GR","authorship_tag":"ABX9TyNkEp+w3IGvVxU4btiDVn7g"},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"c91faf60c7c64c1b9e50744dab99641c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2c49e52f8d2d4fa095e25b91335b62f0","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_63c2a371121f43a5abe887103e47eba4","IPY_MODEL_da3781e0b64a4309bb82c1c40ae83fb5"]}},"2c49e52f8d2d4fa095e25b91335b62f0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"63c2a371121f43a5abe887103e47eba4":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6968588a6bee4727a065b245915cd367","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":10,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":10,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_575d8abd6a5c4fcf91ca02d9497affac"}},"da3781e0b64a4309bb82c1c40ae83fb5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_90cfa2229ede4e6eb45428436258833f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 10/10 [00:49&lt;00:00,  4.92s/it]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d2865dbf763a4cb680a32673b1f80984"}},"6968588a6bee4727a065b245915cd367":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"575d8abd6a5c4fcf91ca02d9497affac":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"90cfa2229ede4e6eb45428436258833f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d2865dbf763a4cb680a32673b1f80984":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e03418d2d6e049d3b57aa0808b23badd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b0caa84e6bca43e9bf910019a786382f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c03a4b11800c441581c281a8a84785b2","IPY_MODEL_95391414076944d88cadee4cb6a50bbc"]}},"b0caa84e6bca43e9bf910019a786382f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c03a4b11800c441581c281a8a84785b2":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_c1ec4ed41df74fe29d3c43c72a4e8f3a","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0fed673785244ede9f0d56f92b680e40"}},"95391414076944d88cadee4cb6a50bbc":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_10f51f19287f486db53dee4e8a4daf66","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:05&lt;00:00, 27.36it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_084ef6d9e88f4195ad5f82fde73ccd1a"}},"c1ec4ed41df74fe29d3c43c72a4e8f3a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0fed673785244ede9f0d56f92b680e40":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"10f51f19287f486db53dee4e8a4daf66":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"084ef6d9e88f4195ad5f82fde73ccd1a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"38ea8dacefb94f2fbf70c5c8ebed8627":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e177ed7547bf4dbe85c6c66ba34b8376","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_48f84e6ee6204d5986217fe62af537d7","IPY_MODEL_73b546680389428ea5fa67bd343fb216"]}},"e177ed7547bf4dbe85c6c66ba34b8376":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"48f84e6ee6204d5986217fe62af537d7":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5b8429c2ffc744c19738013e4a5afd45","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6c1e5d0a0f1849f8b72d47ae3742c515"}},"73b546680389428ea5fa67bd343fb216":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ae8369ed18db4924b68d7341d19334dc","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:44&lt;00:00,  3.10it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a4192219910d4d2f96512adfb27de0bf"}},"5b8429c2ffc744c19738013e4a5afd45":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6c1e5d0a0f1849f8b72d47ae3742c515":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ae8369ed18db4924b68d7341d19334dc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a4192219910d4d2f96512adfb27de0bf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4874f3ff50b14ce4927bbb8dd68af3a3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c45798c2a3f340f4ba09897a49a663d4","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5c496ef179f94621a5cd2fea36e9583e","IPY_MODEL_dcade043e99a4f3794d385f7c17a049d"]}},"c45798c2a3f340f4ba09897a49a663d4":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5c496ef179f94621a5cd2fea36e9583e":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ccd71773cae94be0b33a03e05c16ec32","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_24fda1c32d1845a9bd52d920d7668281"}},"dcade043e99a4f3794d385f7c17a049d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ffea30ecb5a54637a1012d1ddadb7791","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:39&lt;00:00,  3.49it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5f3ef6c7bc3e42249381e43698b79772"}},"ccd71773cae94be0b33a03e05c16ec32":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"24fda1c32d1845a9bd52d920d7668281":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ffea30ecb5a54637a1012d1ddadb7791":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5f3ef6c7bc3e42249381e43698b79772":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3f8db6738e0940548ae8acf7aee4160f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b7275b12bf304608b05948bf876ef988","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3ceb119a4c9a4054be1817ce7e741006","IPY_MODEL_9cc3ffb991374b09a9a594e9937e837c"]}},"b7275b12bf304608b05948bf876ef988":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3ceb119a4c9a4054be1817ce7e741006":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_0f0fad9bf9e94cbab45fd990f621c54f","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_dbdbf910b34e48cca6dabd407e07179b"}},"9cc3ffb991374b09a9a594e9937e837c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a67fd257b77742aeaf28148e954a34ac","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:34&lt;00:00,  3.98it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7bd11894527a4623bd07996b47659f69"}},"0f0fad9bf9e94cbab45fd990f621c54f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"dbdbf910b34e48cca6dabd407e07179b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a67fd257b77742aeaf28148e954a34ac":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7bd11894527a4623bd07996b47659f69":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3120ff5ed57f4939a8fb5474d7557f54":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1ca8f95d8e4448a484fb6d43000c0a43","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b06a77b337834666b3275a1b0ad9beed","IPY_MODEL_f29a6e1a74ac4fe887b67aa3e79968a2"]}},"1ca8f95d8e4448a484fb6d43000c0a43":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b06a77b337834666b3275a1b0ad9beed":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ba31064b5c69420e8ee6a3e983504d37","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8f42f74c32f74d92925be3d8bdd7da62"}},"f29a6e1a74ac4fe887b67aa3e79968a2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c804cbbc868f4104aaf6214472359e28","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:29&lt;00:00,  4.64it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_85914229fc7745579374515bf3e869d0"}},"ba31064b5c69420e8ee6a3e983504d37":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8f42f74c32f74d92925be3d8bdd7da62":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c804cbbc868f4104aaf6214472359e28":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"85914229fc7745579374515bf3e869d0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4b5b029b21f24450be7f214a498f6ce9":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_57f02264e2da4681ab4b5c915d712ed3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a35ab6b22b0546a4852dcd8522bd9068","IPY_MODEL_069641da4c604402a1aa630f97092688"]}},"57f02264e2da4681ab4b5c915d712ed3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a35ab6b22b0546a4852dcd8522bd9068":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f6d5bacdee8a40278e07a8f76f557095","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5c412116cb7140618605341d1c16aa88"}},"069641da4c604402a1aa630f97092688":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a603f629c6ed49c88a53b04c7549243b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:24&lt;00:00,  5.57it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_675edbdecf194779bb08409f33881c4f"}},"f6d5bacdee8a40278e07a8f76f557095":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5c412116cb7140618605341d1c16aa88":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a603f629c6ed49c88a53b04c7549243b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"675edbdecf194779bb08409f33881c4f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6500a5ed837042399efade6e3c9d3606":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a103264206af46f6b0ce2b4cfe17fa38","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_a663830e16664372b2150794748cb99a","IPY_MODEL_6ec2a50245b046e18cf662a759f99d40"]}},"a103264206af46f6b0ce2b4cfe17fa38":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a663830e16664372b2150794748cb99a":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5b3a645b9c2e4fa9b64046d67df2f0d8","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_25cf520de8854955ba2b115e63648d51"}},"6ec2a50245b046e18cf662a759f99d40":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a59d310d10d843d4b320fd8d38a489f5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:19&lt;00:00,  6.96it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a529d22cf383477db04a3cd1e3199fbe"}},"5b3a645b9c2e4fa9b64046d67df2f0d8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"25cf520de8854955ba2b115e63648d51":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a59d310d10d843d4b320fd8d38a489f5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a529d22cf383477db04a3cd1e3199fbe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5e4a1eb251ab4984b4a751eccd03f783":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_f491bebb4a064ab5863efa1907629cef","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c6322b91bf7f4ce4bac5dfa46e5a83ff","IPY_MODEL_4c9307fed3b14d8c8572f5c9fd65289b"]}},"f491bebb4a064ab5863efa1907629cef":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c6322b91bf7f4ce4bac5dfa46e5a83ff":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_647f89a11bdb4526a7f6fcf9c4397460","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1f780c21b0e04b52afbc1a30d4223fa8"}},"4c9307fed3b14d8c8572f5c9fd65289b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_84898d18362b47608d0e7c3e0e2bead8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:04&lt;00:00, 27.83it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a441741e74c6446d84c56546d3171d5e"}},"647f89a11bdb4526a7f6fcf9c4397460":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1f780c21b0e04b52afbc1a30d4223fa8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"84898d18362b47608d0e7c3e0e2bead8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a441741e74c6446d84c56546d3171d5e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"22647bde3d6c459c846c62849a0e815a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_61753bf6efc747438956f818d7a1738d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_b90f784874fd42e9984fc43a58973e08","IPY_MODEL_fc37ae29fdfb47789a7b7f34c8d46275"]}},"61753bf6efc747438956f818d7a1738d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b90f784874fd42e9984fc43a58973e08":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7d03c7537f324c04a8a0cf818ac3f418","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a7ac5bed1d124ee28fb7c16e25050a4f"}},"fc37ae29fdfb47789a7b7f34c8d46275":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_73726318cfb347f89ba2af2163f8c22d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:09&lt;00:00, 13.80it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f0db8974da6f4b49945f6dea1f9cddb1"}},"7d03c7537f324c04a8a0cf818ac3f418":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a7ac5bed1d124ee28fb7c16e25050a4f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"73726318cfb347f89ba2af2163f8c22d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f0db8974da6f4b49945f6dea1f9cddb1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"218b1661b9324543b2ab10744be12be8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_3c9359f0cd134e5b9bd5c97ffffe704f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f9e292d44f354eaaa19aa5d4cfb234a8","IPY_MODEL_f75cd59c7c7a482a9c915bb506d32221"]}},"3c9359f0cd134e5b9bd5c97ffffe704f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f9e292d44f354eaaa19aa5d4cfb234a8":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_383dac986d64450fb9e0b8d442b1c4e0","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":137,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":137,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bd219189ed6b469f9d8487dd00e0fc36"}},"f75cd59c7c7a482a9c915bb506d32221":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e36abadabefc42c98a4a075b0dfd88af","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 137/137 [00:05&lt;00:00, 27.19it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f121b048c88b4e8c8dc15040c936544f"}},"383dac986d64450fb9e0b8d442b1c4e0":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"bd219189ed6b469f9d8487dd00e0fc36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e36abadabefc42c98a4a075b0dfd88af":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f121b048c88b4e8c8dc15040c936544f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e8b895f1e9954ba3880fe52cd38f104f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_d689e1a8d2064b839dae0b98397a9836","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2272effbe3a6402f8d3a56795ccbe2f4","IPY_MODEL_50aa79992b4c47cca045a7174dc956ce"]}},"d689e1a8d2064b839dae0b98397a9836":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2272effbe3a6402f8d3a56795ccbe2f4":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d4be06e7099b462b83f936e4ea3946ca","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":300,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":300,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_04b20d4500ae4b5abb5f5db78b3ea15b"}},"50aa79992b4c47cca045a7174dc956ce":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ec8dbbf2cd394c18b4609b2328654d1a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 300/300 [03:19&lt;00:00,  1.51it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b40c0b0d369e4057b494ef9ce2dcdab2"}},"d4be06e7099b462b83f936e4ea3946ca":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"04b20d4500ae4b5abb5f5db78b3ea15b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ec8dbbf2cd394c18b4609b2328654d1a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b40c0b0d369e4057b494ef9ce2dcdab2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a66c2580a1ef40e7b12e9142e4302065":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_4b38ec0db87f408483c7f083538a2f8c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1c38b594e9db4410b561705ec1a98f77","IPY_MODEL_901e0aad96684fe9b86d185e500e1539"]}},"4b38ec0db87f408483c7f083538a2f8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1c38b594e9db4410b561705ec1a98f77":{"model_module":"@jupyter-widgets/controls","model_name":"IntProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_74e3d1c080df449b99f20c30ce3b8f39","_dom_classes":[],"description":"100%","_model_name":"IntProgressModel","bar_style":"success","max":20466,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":20466,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_0accee4e1e9a4502888f00f25753f897"}},"901e0aad96684fe9b86d185e500e1539":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7ac388ce08c54292b3e5d7b329ad88d8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 20466/20466 [02:13&lt;00:00, 153.00it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_27b8ee31cae94e69ad30f10ec2baba88"}},"74e3d1c080df449b99f20c30ce3b8f39":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"0accee4e1e9a4502888f00f25753f897":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7ac388ce08c54292b3e5d7b329ad88d8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"27b8ee31cae94e69ad30f10ec2baba88":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"qwOt5ZmrBd6H","colab_type":"code","outputId":"dd5eb9cf-6cb5-418d-f74e-2637007a3838","executionInfo":{"status":"ok","timestamp":1586416997013,"user_tz":420,"elapsed":1748,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["cd /content/drive/My Drive/Thesis/code/relation-prediction-2"],"execution_count":21,"outputs":[{"output_type":"stream","text":["/content/drive/My Drive/Thesis/code/relation-prediction-2\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6s8Y8rPhgP3J","colab_type":"code","colab":{}},"source":["pip install torchkge --quiet"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"S8_iqMZLg50K","colab_type":"code","colab":{}},"source":["pip install torch-scatter==latest+cu101 -f https://pytorch-geometric.com/whl/torch-1.4.0.html --quiet"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"GmJPSc0UBtfm","colab_type":"code","outputId":"81dd3270-e5cc-4be3-e082-ff3574ecc748","executionInfo":{"status":"ok","timestamp":1586417011749,"user_tz":420,"elapsed":11473,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":50}},"source":["%load_ext autoreload\n","%autoreload "],"execution_count":24,"outputs":[{"output_type":"stream","text":["The autoreload extension is already loaded. To reload it, use:\n","  %reload_ext autoreload\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"qNKesfEsCzTT","colab_type":"code","colab":{}},"source":["import importlib"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"usklkLwg_lBs","colab_type":"code","colab":{}},"source":["from tqdm import *\n","import tqdm"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"RZFrEivVKqGe","colab_type":"code","colab":{}},"source":["from layers import SpecialSpmmFinal"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"aN9wK09tB5iq","colab_type":"code","colab":{}},"source":["import train \n","importlib.reload(train)\n","from train import *"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"iolNZ4gQByT0","colab_type":"code","colab":{}},"source":["import torch\n","import torch.nn as nn \n","\n","from functools import reduce\n","from operator import mul\n","\n","from torch_scatter import scatter\n","from embedding import EmbeddingMul2\n","\n","from sklearn.metrics.pairwise import pairwise_distances"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZjheHvi2A_7y","colab_type":"code","colab":{}},"source":["kg_train, kg_test, kg_val = load_fb15k237()\n","args = Args(100, 200, 100, 2, 100, 2000, 0.001, 10, 'cuda', 'sgd')"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"ckBArh1zA_71","colab_type":"code","outputId":"f9bd28d3-c7f4-4613-a734-33e32d418a85","executionInfo":{"status":"ok","timestamp":1586417036117,"user_tz":420,"elapsed":14943,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["n_ent, n_rel = kg_train.n_ent, kg_train.n_rel\n","total_triplets = get_valid_triplets(kg_train, kg_test, kg_val)"],"execution_count":31,"outputs":[{"output_type":"stream","text":["Number of unique triplets: 620232\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GWBaZFunA_79","colab_type":"code","colab":{}},"source":["dataloader = DataLoader(kg_train, batch_size=args.batch_size, shuffle=False, pin_memory=cuda.is_available())\n","ent_embed, rel_embed = get_init_embed()"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"sawtOs2vKAaz","colab_type":"code","colab":{}},"source":["class KGLayer(nn.Module):\n","    def __init__(self, n_entities, n_relations, ent_embed, rel_embed, in_dim, out_dim, concat=True, device=\"gpu\"):\n","        super(KGLayer, self).__init__()\n","\n","        self.n_entities = n_entities\n","        self.n_relations = n_relations\n","        self.in_dim = in_dim\n","        self.out_dim = out_dim\n","        self.device = device\n","\n","        self.a = nn.Linear(3 * in_dim, out_dim).to(device)\n","        nn.init.xavier_normal_(self.a.weight.data, gain=1.414)\n","\n","        self.concat = concat\n","\n","        self.a_2 = nn.Linear(out_dim, 1).to(device)\n","        nn.init.xavier_normal_(self.a_2.weight.data, gain=1.414)\n","\n","        self.special_spmm_final = SpecialSpmmFinal()\n","\n","        # self.ent_embed = EmbeddingMul2(n_entities, in_dim, ent_embed, True, torch.device(device))\n","        # self.rel_embed = EmbeddingMul2(n_relations, in_dim, rel_embed, True, torch.device(device))\n","\n","        self.ent_embed = nn.Embedding(n_entities, in_dim).to(device)\n","        self.rel_embed = nn.Embedding(n_relations, in_dim).to(device)\n","    \n","    def forward(self, triplets):\n","        N = self.n_entities\n","\n","        h = torch.cat((\n","            self.ent_embed(triplets[:, 0]),\n","            self.ent_embed(triplets[:, 1]),\n","            self.rel_embed(triplets[:, 2])\n","        ), dim=1)\n","        c = self.a(h)\n","        b = F.leaky_relu(self.a_2(c))\n","        e_b = torch.exp(b)\n","\n","        temp = triplets.t()\n","        edges = torch.stack([temp[0], temp[1]])\n","\n","        ebs = self.special_spmm_final(edges, e_b, N, e_b.shape[0], 1)\n","        temp1 = e_b * c\n","\n","        hs = self.special_spmm_final(edges, temp1,  N, e_b.shape[0], self.out_dim)\n","\n","        ebs[ebs == 0] = 1e-12\n","\n","\n","        h_ent = hs / ebs\n","\n","        index = triplets[:, 2]\n","        h_rel = scatter(temp1, index=index, dim=0, reduce=\"mean\")\n","\n","        # del h \n","        # torch.cuda.empty_cache()\n","\n","        if self.concat:\n","            return F.elu(h_ent), F.elu(h_rel)\n","        else:\n","            return h_ent, h_rel"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"rsiRp-VUVTTP","colab_type":"code","colab":{}},"source":["model = KGLayer(n_ent, n_rel, ent_embed, rel_embed, 100, 100, True, \"cuda\")"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"iQrOXUj9bwLg","colab_type":"code","colab":{}},"source":["optimizer = SGD(model.parameters(), lr=args.lr)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"IgLg-QNoRQVi","colab_type":"code","colab":{}},"source":["batches = [b for b in dataloader]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"nMxXdo4oWX21","colab_type":"code","outputId":"a253b33b-d054-4d48-aafe-8a0c5c615513","executionInfo":{"status":"ok","timestamp":1586416822141,"user_tz":420,"elapsed":68098,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":794,"referenced_widgets":["c91faf60c7c64c1b9e50744dab99641c","2c49e52f8d2d4fa095e25b91335b62f0","63c2a371121f43a5abe887103e47eba4","da3781e0b64a4309bb82c1c40ae83fb5","6968588a6bee4727a065b245915cd367","575d8abd6a5c4fcf91ca02d9497affac","90cfa2229ede4e6eb45428436258833f","d2865dbf763a4cb680a32673b1f80984","e03418d2d6e049d3b57aa0808b23badd","b0caa84e6bca43e9bf910019a786382f","c03a4b11800c441581c281a8a84785b2","95391414076944d88cadee4cb6a50bbc","c1ec4ed41df74fe29d3c43c72a4e8f3a","0fed673785244ede9f0d56f92b680e40","10f51f19287f486db53dee4e8a4daf66","084ef6d9e88f4195ad5f82fde73ccd1a","38ea8dacefb94f2fbf70c5c8ebed8627","e177ed7547bf4dbe85c6c66ba34b8376","48f84e6ee6204d5986217fe62af537d7","73b546680389428ea5fa67bd343fb216","5b8429c2ffc744c19738013e4a5afd45","6c1e5d0a0f1849f8b72d47ae3742c515","ae8369ed18db4924b68d7341d19334dc","a4192219910d4d2f96512adfb27de0bf","4874f3ff50b14ce4927bbb8dd68af3a3","c45798c2a3f340f4ba09897a49a663d4","5c496ef179f94621a5cd2fea36e9583e","dcade043e99a4f3794d385f7c17a049d","ccd71773cae94be0b33a03e05c16ec32","24fda1c32d1845a9bd52d920d7668281","ffea30ecb5a54637a1012d1ddadb7791","5f3ef6c7bc3e42249381e43698b79772","3f8db6738e0940548ae8acf7aee4160f","b7275b12bf304608b05948bf876ef988","3ceb119a4c9a4054be1817ce7e741006","9cc3ffb991374b09a9a594e9937e837c","0f0fad9bf9e94cbab45fd990f621c54f","dbdbf910b34e48cca6dabd407e07179b","a67fd257b77742aeaf28148e954a34ac","7bd11894527a4623bd07996b47659f69","3120ff5ed57f4939a8fb5474d7557f54","1ca8f95d8e4448a484fb6d43000c0a43","b06a77b337834666b3275a1b0ad9beed","f29a6e1a74ac4fe887b67aa3e79968a2","ba31064b5c69420e8ee6a3e983504d37","8f42f74c32f74d92925be3d8bdd7da62","c804cbbc868f4104aaf6214472359e28","85914229fc7745579374515bf3e869d0","4b5b029b21f24450be7f214a498f6ce9","57f02264e2da4681ab4b5c915d712ed3","a35ab6b22b0546a4852dcd8522bd9068","069641da4c604402a1aa630f97092688","f6d5bacdee8a40278e07a8f76f557095","5c412116cb7140618605341d1c16aa88","a603f629c6ed49c88a53b04c7549243b","675edbdecf194779bb08409f33881c4f","6500a5ed837042399efade6e3c9d3606","a103264206af46f6b0ce2b4cfe17fa38","a663830e16664372b2150794748cb99a","6ec2a50245b046e18cf662a759f99d40","5b3a645b9c2e4fa9b64046d67df2f0d8","25cf520de8854955ba2b115e63648d51","a59d310d10d843d4b320fd8d38a489f5","a529d22cf383477db04a3cd1e3199fbe","5e4a1eb251ab4984b4a751eccd03f783","f491bebb4a064ab5863efa1907629cef","c6322b91bf7f4ce4bac5dfa46e5a83ff","4c9307fed3b14d8c8572f5c9fd65289b","647f89a11bdb4526a7f6fcf9c4397460","1f780c21b0e04b52afbc1a30d4223fa8","84898d18362b47608d0e7c3e0e2bead8","a441741e74c6446d84c56546d3171d5e","22647bde3d6c459c846c62849a0e815a","61753bf6efc747438956f818d7a1738d","b90f784874fd42e9984fc43a58973e08","fc37ae29fdfb47789a7b7f34c8d46275","7d03c7537f324c04a8a0cf818ac3f418","a7ac5bed1d124ee28fb7c16e25050a4f","73726318cfb347f89ba2af2163f8c22d","f0db8974da6f4b49945f6dea1f9cddb1","218b1661b9324543b2ab10744be12be8","3c9359f0cd134e5b9bd5c97ffffe704f","f9e292d44f354eaaa19aa5d4cfb234a8","f75cd59c7c7a482a9c915bb506d32221","383dac986d64450fb9e0b8d442b1c4e0","bd219189ed6b469f9d8487dd00e0fc36","e36abadabefc42c98a4a075b0dfd88af","f121b048c88b4e8c8dc15040c936544f"]}},"source":["for epoch in tnrange(10):\n","    losses = []\n","    for i in tnrange(len(batches)):\n","        batch = batches[i]\n","        triplets = torch.stack(batch)\n","        triplets, labels, nodes, edges = negative_sampling(triplets, n_ent, args.negative_rate)\n","        triplets, labels = triplets.to(args.device), labels.to(args.device)\n","    \n","        model.zero_grad()\n","    \n","        # start = time.time()\n","        model.train()\n","        ent_embed_, rel_embed_ = model(triplets)\n","        loss = loss_func2(triplets, args.negative_rate, ent_embed_, rel_embed_, device=\"cuda\")\n","        loss.backward()\n","        optimizer.step()\n","    \n","        # del triplets\n","        # del labels\n","        # del ent_embed_\n","        # del rel_embed_\n","        # del nodes \n","        # del edges  \n","        torch.cuda.empty_cache()\n","    \n","        losses.append(loss.item())\n","        # print(loss.item())\n","        # del loss \n","        torch.cuda.empty_cache()\n","    \n","    print(sum(losses) / len(losses))"],"execution_count":17,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:1: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n","  \"\"\"Entry point for launching an IPython kernel.\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"c91faf60c7c64c1b9e50744dab99641c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=10), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:3: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n","  This is separate from the ipykernel package so we can avoid doing imports until\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e03418d2d6e049d3b57aa0808b23badd","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.846565667730179\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"38ea8dacefb94f2fbf70c5c8ebed8627","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.800519821417593\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4874f3ff50b14ce4927bbb8dd68af3a3","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.777308425764097\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3f8db6738e0940548ae8acf7aee4160f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.736975579366197\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3120ff5ed57f4939a8fb5474d7557f54","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.712405284825903\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"4b5b029b21f24450be7f214a498f6ce9","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.6850282467194715\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6500a5ed837042399efade6e3c9d3606","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.654556525014613\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"5e4a1eb251ab4984b4a751eccd03f783","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.637006338495407\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"22647bde3d6c459c846c62849a0e815a","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.617236360146181\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"218b1661b9324543b2ab10744be12be8","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=137), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","4.589763362912366\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"fGOagQiCcecW","colab_type":"code","colab":{}},"source":["from typing import Set, Tuple\n","def validate(model: KGLayer, kg: KnowledgeGraph, total_triplets: Set[Tuple], batch_size=1000, device='cuda'):\n","    batch_size = 1\n","\n","\n","    n_ranks = 10\n","    k = kg.n_ent\n","\n","    dataloader = DataLoader(kg, batch_size, shuffle=True)\n","\n","    hits = [[] for _ in range(10)]\n","    ranks = [] \n","\n","    rankHs, rankTs = [], []\n","\n","    head_rank_mean, tail_rank_mean, filtered_head_rank_mean, filtered_tail_rank_mean = [0] * 4\n","\n","    head_hits_10_raw, head_hits_10_filter, tail_hits_10_raw, tail_hits_10_filter = [0] * 4\n","\n","    data = [d for d in dataloader]\n","\n","    for i in tnrange(300):\n","        batch = data[i]\n","        \n","        src, dst, rel = batch\n","\n","        if device == 'cuda':\n","            src = src.to(device)\n","            dst = dst.to(device)\n","            rel = rel.to(device)\n","\n","        src = model.ent_embed(src)\n","        dst = model.ent_embed(dst)\n","        rel = model.rel_embed(rel)\n","\n","        loss = torch.norm(src + rel - dst, 2, 1)\n","        loss = loss.repeat(kg.n_ent)\n","\n","\n","        src_ = src.repeat(kg.n_ent, 1)\n","        dst_ = dst.repeat(kg.n_ent, 1)\n","        rel_ = rel.repeat(kg.n_ent, 1)\n","\n","        dist_head_prediction = model.ent_embed.weight + rel_ - dst_\n","        dist_tail_prediction = src_ + rel_ - model.ent_embed.weight\n","\n","        _, head_prediction = torch.topk(torch.sum(torch.abs(dist_head_prediction), dim=1), k=k)\n","        _, tail_prediction = torch.topk(torch.sum(torch.abs(dist_tail_prediction), dim=1), k=k)\n","\n","        head_prediction = head_prediction.cpu()\n","        tail_prediction = tail_prediction.cpu()\n","\n","        head_rank_raw, tail_rank_raw, head_rank_filter, tail_rank_filter = [0] * 4\n","\n","\n","        s, d, r = [b[0] for b in batch] \n","\n","        for candidate in head_prediction:\n","            if candidate == s:\n","                break\n","            else:\n","                head_rank_raw += 1 \n","                if (candidate, d, r) in total_triplets:\n","                    continue\n","                else:\n","                    head_rank_filter += 1\n","        \n","        for candidate in tail_prediction:\n","            if candidate == d:\n","                break \n","            else:\n","                tail_rank_raw += 1\n","                if (s, candidate, r) in total_triplets:\n","                    continue\n","                else:\n","                    tail_rank_filter += 1 \n","\n","        head_rank_mean += head_rank_raw\n","        tail_rank_mean += tail_rank_raw\n","\n","        filtered_head_rank_mean += head_rank_filter\n","        filtered_tail_rank_mean += tail_rank_filter\n","\n","        if head_rank_raw < 10:\n","            head_hits_10_raw += 1\n","        \n","        if tail_rank_raw < 10:\n","            tail_hits_10_raw += 1\n","\n","        if head_rank_filter < 10:\n","            head_hits_10_filter += 1\n","        \n","        if tail_rank_filter < 10:\n","            tail_hits_10_filter += 1\n","        \n","    \n","    head_rank_mean /= 200\n","    tail_rank_mean /= 200\n","\n","    filtered_head_rank_mean /= 200\n","    filtered_tail_rank_mean /= 200\n","\n","    print(f'Head Rank Mean : {head_rank_mean} | Hits@10 : {head_hits_10_raw}')\n","    print(f'Tail Rank Mean : {tail_rank_mean} | Hits@10 : {tail_hits_10_raw}')\n","\n","    print(f'Filtered Head Rank Mean: {filtered_head_rank_mean}')\n","    print(f'Filtered Tail Rank MEan: {filtered_tail_rank_mean}')\n","\n","\n","    print()\n"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"IXv3kkb1uH2H","colab_type":"code","outputId":"21fdc3d5-0a06-47f9-f042-e790af917be7","executionInfo":{"status":"ok","timestamp":1586416858593,"user_tz":420,"elapsed":101329,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":168,"referenced_widgets":["e8b895f1e9954ba3880fe52cd38f104f","d689e1a8d2064b839dae0b98397a9836","2272effbe3a6402f8d3a56795ccbe2f4","50aa79992b4c47cca045a7174dc956ce","d4be06e7099b462b83f936e4ea3946ca","04b20d4500ae4b5abb5f5db78b3ea15b","ec8dbbf2cd394c18b4609b2328654d1a","b40c0b0d369e4057b494ef9ce2dcdab2"]}},"source":["model.eval()\n","validate(model, kg_val, total_triplets, 100, 'cuda')"],"execution_count":19,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:22: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e8b895f1e9954ba3880fe52cd38f104f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=300), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Head Rank Mean : 10696.24 | Hits@10 : 0\n","Tail Rank Mean : 10887.485 | Hits@10 : 0\n","Filtered Head Rank Mean: 10696.24\n","Filtered Tail Rank MEan: 10887.485\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"hGmHnTBXcy-e","colab_type":"code","colab":{}},"source":["ent_embed = model.ent_embed.weight.detach().cpu().numpy()\n","rel_embed = model.rel_embed.weight.detach().cpu().numpy()"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"UbH2n1Mec5Zn","colab_type":"code","colab":{}},"source":["dl = DataLoader(kg_val, 1, shuffle=True)\n","data = [d for d in dl]\n","triplets = data[:20]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"DAVPhi6NeCB0","colab_type":"code","colab":{}},"source":["src_ = [triplet[0].item() for triplet in triplets]\n","dst_ = [triplet[1].item() for triplet in triplets]\n","rel_ = [triplet[2].item() for triplet in triplets]\n","\n","src = ent_embed[src_]\n","dst = ent_embed[dst_]\n","rel = rel_embed[rel_]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"hCh1x8ileAm0","colab_type":"code","colab":{}},"source":["dist = pairwise_distances(dst - rel, ent_embed, metric=\"manhattan\")"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"SoAXJdlNeqtn","colab_type":"code","colab":{}},"source":["rankArrayHead = np.argsort(dist, axis=1)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"JRnTchhRe5Xg","colab_type":"code","colab":{}},"source":["rankListHead =  [int(np.argwhere(e[1] == e[0])) for e in zip(src_, rankArrayHead)]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"CBgfrpv_f274","colab_type":"code","colab":{}},"source":["isHit10Head = [x for x in rankListHead if x < 10]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"nZWBrmenjbiX","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"outputId":"7e057cde-4b27-4a30-abbc-57afda43463a","executionInfo":{"status":"ok","timestamp":1586395730851,"user_tz":420,"elapsed":1260,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}}},"source":[""],"execution_count":108,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[0]"]},"metadata":{"tags":[]},"execution_count":108}]},{"cell_type":"code","metadata":{"id":"xw3xcEI1iVfy","colab_type":"code","colab":{}},"source":["e = src_[0]\n","ee = rankArrayHead[0]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"kJdHULqsiwL8","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"outputId":"a0f12ded-976d-4c56-d31e-d68ac96e7a32","executionInfo":{"status":"ok","timestamp":1586395587729,"user_tz":420,"elapsed":2369,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}}},"source":["e"],"execution_count":101,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([7814])"]},"metadata":{"tags":[]},"execution_count":101}]},{"cell_type":"code","metadata":{"id":"yi0TwaFzfAaD","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":34},"outputId":"0b3213f9-8888-4362-a718-45a407c7904a","executionInfo":{"status":"ok","timestamp":1586394572848,"user_tz":420,"elapsed":2332,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}}},"source":["triplets[0]"],"execution_count":61,"outputs":[{"output_type":"execute_result","data":{"text/plain":["[tensor([4576]), tensor([4409]), tensor([191])]"]},"metadata":{"tags":[]},"execution_count":61}]},{"cell_type":"code","metadata":{"id":"ZTzLoV_6u5GT","colab_type":"code","outputId":"8a25fde4-1323-499a-9bc8-0342338549cb","executionInfo":{"status":"ok","timestamp":1586416879729,"user_tz":420,"elapsed":5469,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":289}},"source":["!nvidia-smi"],"execution_count":20,"outputs":[{"output_type":"stream","text":["Thu Apr  9 07:21:17 2020       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 440.64.00    Driver Version: 418.67       CUDA Version: 10.1     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|===============================+======================+======================|\n","|   0  Tesla P4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   57C    P0    25W /  75W |    623MiB /  7611MiB |      0%      Default |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                       GPU Memory |\n","|  GPU       PID   Type   Process name                             Usage      |\n","|=============================================================================|\n","+-----------------------------------------------------------------------------+\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"AsreyYm_TIGX","colab_type":"code","outputId":"e8f59113-f5ec-425b-97e2-aa76ea8cfdbe","executionInfo":{"status":"ok","timestamp":1586392060300,"user_tz":420,"elapsed":164054,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":136}},"source":["dataloader = DataLoader(kg_val, 1, shuffle=True)\n","data = [d for d  in dataloader]\n","d = data[0]\n","model.eval()"],"execution_count":21,"outputs":[{"output_type":"execute_result","data":{"text/plain":["KGLayer(\n","  (a): Linear(in_features=300, out_features=100, bias=True)\n","  (a_2): Linear(in_features=100, out_features=1, bias=True)\n","  (special_spmm_final): SpecialSpmmFinal()\n","  (ent_embed): Embedding(14541, 100)\n","  (rel_embed): Embedding(237, 100)\n",")"]},"metadata":{"tags":[]},"execution_count":21}]},{"cell_type":"code","metadata":{"id":"3-fdvyGQYjbE","colab_type":"code","colab":{}},"source":["head = model.ent_embed(d[0].to(\"cuda\"))\n","tail = model.ent_embed(d[1].to(\"cuda\"))\n","rel  = model.rel_embed(d[2].to(\"cuda\"))"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"v1DHeb7QZWWb","colab_type":"code","colab":{}},"source":["target_loss = torch.norm(head + rel - tail, 2).repeat(n_ent, 1)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"3NRySo_JaL9-","colab_type":"code","colab":{}},"source":["tmphead = head.repeat(n_ent, 1)\n","tmptail = tail.repeat(n_ent, 1)\n","tmprel = rel.repeat(n_ent, 1)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"jIfid7-NaP27","colab_type":"code","colab":{}},"source":["tmpHloss = torch.norm(model.ent_embed.weight + tmprel - tmptail, 2, 1).view(-1, 1)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"pjkq6yfSasac","colab_type":"code","outputId":"1640455b-ed5c-486b-a84a-1fadc320af3e","executionInfo":{"status":"ok","timestamp":1586392060304,"user_tz":420,"elapsed":164031,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":136}},"source":["tmpHloss"],"execution_count":26,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[18.1168],\n","        [19.2851],\n","        [17.9797],\n","        ...,\n","        [20.4873],\n","        [20.5492],\n","        [17.9054]], device='cuda:0', grad_fn=<ViewBackward>)"]},"metadata":{"tags":[]},"execution_count":26}]},{"cell_type":"code","metadata":{"id":"zYPhn8wRa0sb","colab_type":"code","colab":{}},"source":["tmpTloss = torch.norm(tmphead + rel - model.ent_embed.weight, 2, 1).view(-1, 1)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"e6BXnPQObCTM","colab_type":"code","outputId":"aea74c74-0f90-452a-97ca-1a7e6c7623c2","executionInfo":{"status":"ok","timestamp":1586392060305,"user_tz":420,"elapsed":164020,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":136}},"source":["tmpTloss"],"execution_count":28,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[18.8130],\n","        [19.0527],\n","        [18.2580],\n","        ...,\n","        [16.3002],\n","        [18.1240],\n","        [18.3511]], device='cuda:0', grad_fn=<ViewBackward>)"]},"metadata":{"tags":[]},"execution_count":28}]},{"cell_type":"code","metadata":{"id":"z6meIkLybDuU","colab_type":"code","colab":{}},"source":["rankH = torch.nonzero(F.relu(target_loss - tmpHloss)).size()[0]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"67-ih0XxbWZz","colab_type":"code","outputId":"2be7951c-7cc8-4a7f-f223-a52bdbe6651f","executionInfo":{"status":"ok","timestamp":1586392060306,"user_tz":420,"elapsed":164001,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["rankH"],"execution_count":30,"outputs":[{"output_type":"execute_result","data":{"text/plain":["11112"]},"metadata":{"tags":[]},"execution_count":30}]},{"cell_type":"code","metadata":{"id":"R7jonoNgb_Uj","colab_type":"code","colab":{}},"source":["rankT = torch.nonzero(F.relu(target_loss - tmpTloss)).size()[0]"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"L8S7xQu_cF_D","colab_type":"code","outputId":"927d0604-7c8f-45f7-fbfa-dd48d1d488fa","executionInfo":{"status":"ok","timestamp":1586392060308,"user_tz":420,"elapsed":163989,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":34}},"source":["rankT"],"execution_count":32,"outputs":[{"output_type":"execute_result","data":{"text/plain":["14308"]},"metadata":{"tags":[]},"execution_count":32}]},{"cell_type":"code","metadata":{"id":"DAwcG368cHP7","colab_type":"code","colab":{}},"source":["def fast_validate(model, kg, total_triplets, device):\n","    dataloader = DataLoader(kg, 1, shuffle=True)\n","    data = [d for d in dataloader]\n","\n","    ranks = []\n","\n","    for i in tnrange(len(data)):\n","        triplet = data[i]\n","        if i:\n","            head = model.ent_embed(triplet[0].to(\"cuda\"))\n","            tail = model.ent_embed(triplet[1].to(\"cuda\"))\n","            rel  = model.rel_embed(triplet[2].to(\"cuda\"))\n","    \n","            targetLoss = torch.norm(head + rel - tail, 2).repeat(kg.n_ent, 1)\n","    \n","            tmpHead = head.repeat(kg.n_ent, 1)\n","            tmpTail = tail.repeat(kg.n_ent, 1)\n","            tmpRel  = rel.repeat(kg.n_ent, 1)\n","    \n","            tmpHloss = torch.norm(model.ent_embed.weight + tmpRel - tmpTail, 2, 1).view(-1, 1)\n","            tmpTloss = torch.norm(tmpHead + tmpRel - model.ent_embed.weight, 2, 1).view(-1, 1)\n","    \n","            rankH = torch.nonzero(F.relu(targetLoss - tmpHloss)).size()[0]\n","            rankT = torch.nonzero(F.relu(targetLoss - tmpTloss)).size()[0]\n","    \n","            ranks.append( (rankH + rankT + 2) / 2 )\n","    \n","    return sum(ranks) / len(ranks)"],"execution_count":0,"outputs":[]},{"cell_type":"code","metadata":{"id":"1hvVZLlLcS1z","colab_type":"code","outputId":"e8bba515-9775-464c-cd30-2cd814a99df4","executionInfo":{"status":"ok","timestamp":1586395909166,"user_tz":420,"elapsed":35665,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}},"colab":{"base_uri":"https://localhost:8080/","height":117,"referenced_widgets":["a66c2580a1ef40e7b12e9142e4302065","4b38ec0db87f408483c7f083538a2f8c","1c38b594e9db4410b561705ec1a98f77","901e0aad96684fe9b86d185e500e1539","74e3d1c080df449b99f20c30ce3b8f39","0accee4e1e9a4502888f00f25753f897","7ac388ce08c54292b3e5d7b329ad88d8","27b8ee31cae94e69ad30f10ec2baba88"]}},"source":["fast_validate(model, kg_val, total_triplets, \"cuda\")"],"execution_count":111,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:7: TqdmDeprecationWarning: Please use `tqdm.notebook.trange` instead of `tqdm.tnrange`\n","  import sys\n"],"name":"stderr"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a66c2580a1ef40e7b12e9142e4302065","version_minor":0,"version_major":2},"text/plain":["HBox(children=(IntProgress(value=0, max=20466), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["7119.410847788908"]},"metadata":{"tags":[]},"execution_count":111}]},{"cell_type":"code","metadata":{"id":"c2N-oxjJZbDZ","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":163},"outputId":"531f3e42-02d9-42df-e8b9-8d650d4e9be7","executionInfo":{"status":"error","timestamp":1586393345002,"user_tz":420,"elapsed":1671,"user":{"displayName":"Sai Ashirwad","photoUrl":"","userId":"01142451817830042483"}}},"source":["data"],"execution_count":1,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-1-c5d84736ba45>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mdata\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;31mNameError\u001b[0m: name 'data' is not defined"]}]},{"cell_type":"code","metadata":{"id":"LPV4UVJfZcO2","colab_type":"code","colab":{}},"source":[""],"execution_count":0,"outputs":[]}]}